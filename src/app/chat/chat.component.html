<ng-container *ngIf="chat$ | async as chat">
  <ng-container *ngIf=" auth.user$ | async as user">

    <div class="chat">

      <div class="msg animated zoomInUp" *ngFor="let msg of chat.messages; trackBy: trackByCreated">

        <div class="user">
          <img [src]="msg.user?.photoURL || 'assets/unicorn.svg'" width="50px">
          <div><span class="tag is-dark">{{ msg.user?.displayName || msg.user?.uid }}</span></div>

          <button *ngIf="chat.uid === user.uid || msg.uid === user.uid" class="button is-danger is-small" (click)="cs.deleteMessage(chat, msg)">Delete</button>

        </div>

        <p>{{ msg.content }}</p>
      </div>
    </div>

    <div class="form">
      <button class="btn btn-outline-primary action submit" routerLink="/">
        <ion-icon name="arrow-back-outline"></ion-icon>
      </button>

      <mat-form-field class="form-field">
        <mat-label>Your message</mat-label>
        <input matInput type="text" [(ngModel)]="newMsg" maxlength="100" (keydown.enter)="submit(chat.id)">
        <button mat-button *ngIf="newMsg" matSuffix mat-icon-button aria-label="Clear" (click)="newMsg=''">
          <ion-icon name="close-outline"></ion-icon>
        </button>
      </mat-form-field>
      <button (click)="submit(chat.id)" class="btn btn-outline-primary action submit" [disabled]="!newMsg">Send</button>

      <span class="fill"></span>

      <span class="tag is-success">
          http://localhost:4200/chats/{{ chat.id }}
      </span>
    </div>

  </ng-container>
</ng-container>
